{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load show_post_list %}
{% block content %}
{% if others_user.icon_url %}
<div style="background-image: url({{ others_user.background.url }}) !important;" class="px-4 pt-0 pb-4 bg-size-head range-specification">
{% else %}
<div class="px-4 pt-0 pb-4 cover range-specification">
{% endif %}
    <div class="media align-items-end profile-head-user">
        <div class="profile mr-3">
          {% if others_user.icon_url %}
          <img src="{{ others_user.icon_url }}" width="140" height="140" class="circle-img rounded mb-2 img-margin">
          {% else %}
          <img src="{% static 'icon/LandLim_Human.png' %}" width="140" height="140" class="rounded mb-2">
          {% endif %}
        </div>
        <div class="media-body mb-5 text-white">
            {% if others_user.nickname %}
            <h4 class="mt-0 mb-0">{{ others_user.nickname }}</h4>
            {% else %}
            <h4 class="mt-0 mb-0">{{ others_user.username }}</h4>
            {% endif %}
            <p class="small mb-4"> <i class="fas fa-map-marker-alt mr-2"></i>LandLim</p>
        </div>
    </div>
</div>
<div class="px-4 pt-0 pb-2 cover_ range-specification"></div>
<div class="bg-main-header p-4 d-flex justify-content-end text-center range-specification">
    <ul class="list-inline mb-0">
        <li class="list-inline-item">
            <h5 class="font-weight-bold mb-0 d-block">{{ others_user_post_num }}</h5><small class="text-color-white"> <i class="fas fa-image mr-1"></i>{% trans "POSTS" %}</small>
        </li>
        <li class="list-inline-item">
            <h5 class="font-weight-bold mb-0 d-block">{{ others_user_post_is_liked_num }}</h5><small class="text-color-white"> <i class="far fa-thumbs-up"></i> {% trans "IS LIKED" %}</small>
        </li>
        <li class="list-inline-item">
          <h5 class="font-weight-bold mb-0 d-block" id="follower_count">{{ others_user_follower_num }}</h5>
          <small class="text-color-white">
            <button class="btn btn-link text-dark p-0 border-0 btn-outline-light button-like" id="follow-button" value="{{ others_user.pk }}">
              <i class="fas fa-user mr-1 small-icon text-color-white"></i>
            </button>{% trans "Follower" %}
          </small>
        </li>
        {% if others_user.pk != others_user.pk %}
        <li class="list-inline-item">
          <h5 class="font-weight-bold mb-0 d-block" id="block_count">{% trans 'Secrets' %}</h5>
          <small class="text-color-white">
            <button class="btn btn-link text-dark p-0 border-0 btn-outline-light button-like" id="block-button" value="{{ others_user.pk }}">
              <i class="fas fa-bell-slash small-icon"></i>
            </button> {% trans "Block" %}
          </small>
        </li>
        {% endif %}
        <li class="list-inline-item">
            <h5 class="font-weight-bold mb-0 d-block">{{ others_user_level }}</h5>
            <small class="text-color-white">
              <i class="fas fa-user mr-1 user-position-icon"></i>
              {% trans "USER LEVEL" %}
            </small>
        </li>
    </ul>
</div>
<div class="timeline-content">
  <div class="timeline">
    <div class="timeline-container primary">
      <div class="timeline-icon">
        <i class="fas fa-user"></i>
      </div>
      <div class="timeline-body">
          <h4 class="timeline-title first"><span class="badge">{% trans "User" %}</span></h4>
          <p>ユーザー情報</p>
          <p class="timeline-subtitle">最終更新日 2021-12-1</p>
      </div>
    </div>
    <div class="timeline-container primary">
        <div class="timeline-icon">
          <i class="fas fa-hand-holding-heart"></i>
        </div>
        <div class="timeline-body">
            <h4 class="timeline-title"><span class="badge">{% trans "Emotion" %}</span></h4>
            <p>パンツを盗まれたような気持ち</p>
            <p class="timeline-subtitle">最終更新日 2021-12-1</p>
        </div>
    </div>
    <div class="timeline-container danger">
        <div class="timeline-icon">
          <i class="fas fa-gamepad"></i>
        </div>
        <div class="timeline-body">
            <h4 class="timeline-title"><span class="badge">{% trans "Hobie" %}</span></h4>
            <p>{{ others_user.hobie }}</p>
            <p class="timeline-subtitle">最終更新日 2021-12-1</p>
        </div>
    </div>
    <div class="timeline-container success">
        <div class="timeline-icon">
          <i class="fas fa-address-card"></i>
        </div>
        <div class="timeline-body">
            <h4 class="timeline-title"><span class="badge">{% trans "Description" %}</span></h4>
            <p>{{ others_user.description }}</p>
            <p class="timeline-subtitle">最終更新日 2021-12-1</p>
        </div>
    </div>
    <div class="timeline-container warning">
        <div class="timeline-icon">
          <i class="far fa-window-maximize"></i>
        </div>
        <div class="timeline-body">
            <h4 class="timeline-title"><span class="badge">{% trans "Link" %}</span></h4>
            <p>{% trans "Web" %} <a style="overflow-wrap: break-word;" href="{{ others_user.web_link }}">{{ others_user.web_link }}</a></p>
            <p>{% trans "Twitter" %} <a style="overflow-wrap: break-word;" href="{{ others_user.twitter_link }}">{{ others_user.twitter_link }}</a></p>
            <p>{% trans "Instagram" %} <a style="overflow-wrap: break-word;" href="{{ others_user.instagram_link }}">{{ others_user.instagram_link }}</a></p>
            <p>{% trans "Facebook" %} <a style="overflow-wrap: break-word;" href="{{ others_user.facebook_link }}">{{ others_user.facebook_link }}</a></p>
            <p class="timeline-subtitle">最終更新日 2021-12-1</p>
        </div>
    </div>
    <div class="timeline-container">
        <div class="timeline-icon">
          <i class="fas fa-flag"></i>
        </div>
        <div class="timeline-body">
            <h4 class="timeline-title"><span class="badge">{% trans "Local" %}</span></h4>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam necessitatibus numquam earum ipsa fugiat veniam suscipit, officiis repudiandae, eum recusandae neque dignissimos. Cum fugit laboriosam culpa, repellendus esse commodi deserunt.</p>
            <p class="timeline-subtitle">最終更新日 2021-12-1</p>
        </div>
    </div>
    <div class="timeline-container info">
        <div class="timeline-icon">
          <i class="fas fa-cut"></i>
        </div>
        <div class="timeline-body">
            <h4 class="timeline-title"><span class="badge">{% trans "Shortcuts" %}</span></h4>
            <p class="Shortcuts"><a href=".usermap"> {% trans "Shortcuts to headline user" %}</a></p>
            <p class="timeline-subtitle">4 Days Ago</p>
        </div>
    </div>
    {% if others_user_post_list %}
    {% for list in others_user_post_list %}
    <div class="timeline-container user">
      {% if list.user.icon_url %}
      <div style="background-image: url({{ list.user.icon_url }});" class="timeline-icon"></div>
      {% else %}
      <div style="background-image: url({% static 'icon/LandLim_Human.png' %});" class="timeline-icon"></div>
      {% endif %}
      <div class="timeline-body">
          <h4 class="timeline-title"><a class="timeline-in-a" href="{% url 'post:post_details' list.pk %}"><span class="badge">タイトル</span></a></h4>
          {% if list.postimage_set.first %}
          <p class="text-align-center"><img class="timeline-content-image" src="{{ list.postimage_set.first.thumbnail_url }}"></p>
          {% endif %}
          <p>{{ list.text | safe | linebreaksbr | truncatechars:110 }}</p>
          <p style="display:inline;" class="timeline-subtitle">6 Hours Ago - Hiiro Uhiyama</p>
          <p class="timeline-subtitle-rightside">
            <i class="far fa-thumbs-up i-style-timeline"></i> {{ list.like_count }}
            <i class="far fa-thumbs-down i-style-timeline"></i> 5
            <i class="far fa-bookmark i-style-timeline"></i> {{ list.bookmark_count }}
            <i class="far fa-comments i-style-timeline"></i> {{ list.comment_count }}
            <i class="far fa-eye i-style-timeline"></i> {{ list.watched_count }}
            <div class="share-div">
              <a class="share-a" href="#"></a>
              <a class="share-a" href="#"></a>
            </div>
          </p>
      </div>
    </div>
    {% endfor %}
    {% endif %}
    <div class="timeline-container info">
      <div class="timeline-icon">
        <i class="fas fa-cut"></i>
      </div>
      <div class="timeline-body">
          <h4 class="timeline-title"><span class="badge">{% trans "Shortcuts" %}</span></h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam necessitatibus numquam earum ipsa fugiat veniam suscipit, officiis repudiandae, eum recusandae neque dignissimos. Cum fugit laboriosam culpa, repellendus esse commodi deserunt.</p>
          <p class="timeline-subtitle">4 Days Ago</p>
      </div>
    </div>
    <div class="timeline-container info">
      <div class="timeline-icon">
        <i class="fas fa-cut"></i>
      </div>
      <div class="timeline-body">
          <h4 class="timeline-title"><span class="badge">{% trans "Shortcuts" %}</span></h4>
          <p class="Shortcuts"><a href=".first"> {% trans "Shortcuts to headline user" %}</a></p>
          <p class="timeline-subtitle">4 Days Ago</p>
      </div>
    </div>
    <div class="timeline-container info">
      <div class="timeline-icon">
        <i class="fas fa-user-times"></i>
      </div>
      <div class="timeline-body">
          <h4 class="timeline-title"><span class="badge">{% trans "Acount Delete" %}</span></h4>
          <p class="Shortcuts"><a href="{% url 'accounts:delete_accounts' %}"> {% trans "Delete Account?" %}</a></p>
          <p class="timeline-subtitle">4 Days Ago</p>
      </div>
    </div>
  </div>
  <div class="py-3 map">
    <div class="row column">
      <div class="usermap" id="mapid"></div>
    </div>
  </div>
</div>
<style>
.img-margin{
  position: relative;
  top: -10.5px;
}
.profile-head-user {
  position: relative;
  bottom: -100px;
}
.a-edit-profiel{
  border-color: #ffffff;
  color: #ffffff;
}
.a-edit-profiel:hover{
  background-color: #ffffff;
  border-color: #ffffff;
  color: #000000;
}
.bg-size-head{
  height: 350px;
  background-size: cover;
  background-repeat: no-repeat;
  margin: 0;
}
.cover {
  background-color: #2A2E43;
  background-size: cover;
  background-repeat: no-repeat
}
.cover_ {
  background: linear-gradient(90deg, #009600 0% 25%, #006400 25% 50%, #BE8200 50% 75%, #FFB400 75% 100%);
  background-size: cover;
  background-repeat: no-repeat
}
.column {
  display: inline;
  flex-direction: column;
}
.green {
  color: #006400;
}
.red {
  color: #FF3333;
}
.blue {
  color: #4285F4;
}
.white {
  color: #ffffff;
}
.image_tm {
  object-fit: cover;
  width: 327.5px;
  height: 327.5px;
  margin: 3.5px;
}
.list {
  text-align: right;
}
.user-position-icon {
  position: relative;
  top: 1.5px;
}
.wrap {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-around;
}
.item {
  width: 50%;
  background-color: #ffffff;
}
@media not all and (min-width: 768px) {
  .item {
    width: 100%;
  }
}
.py-top {
  margin-top: 66.5px;
}
.py-buttom {
  margin-bottom: 21.5px;
}
.info-p {
  font-size: 16.5px;
}
@import url("https://fonts.googleapis.com/css?family=Niramit:300,300i,700");
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
.timeline-content {
  max-width: 1050px;
  margin: 15px auto 0;
}
.timeline {
  position: relative;
  padding-left: 4.0rem;
  margin: 0 0 0 25px;
  color: #fafafa;
}
.timeline:before {
  content: "";
  position: absolute;
  left: -1.2px;
  top: 8.65px;
  width: 4.5px;
  height: 100%;
  background: #2A2E43;
}
.timeline .timeline-container {
  position: relative;
  margin-bottom: 0.5rem;
}
.timeline .timeline-container .timeline-icon {
  position: absolute;
  left: -88px;
  top: 4px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  text-align: center;
  font-size: 2rem;
  background: #4f537b;
}
.timeline .timeline-container .timeline-icon i {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  font-size: 18.5px;
}
.timeline .timeline-container .timeline-icon img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
}
.timeline .timeline-container .timeline-body {
  background: #2A2E43;
  border-radius: 3px;
  padding: 20px 20px 20px 15px;
  box-shadow: 1px 3px 9px rgba(0, 0, 0, 0.1);
  max-width: 1050px;
  width: 100%;
}
.timeline .timeline-container .timeline-body:before {
  content: "";
  background: inherit;
  width: 20px;
  height: 20px;
  display: block;
  position: absolute;
  left: -10px;
  transform: rotate(45deg);
  border-radius: 0 0 0 2px;
}
.timeline .timeline-container .timeline-body .timeline-title {
  margin-bottom: 1.4rem;
}
.timeline .timeline-container .timeline-body .timeline-title .badge {
  background: #4f537b;
  padding: 4px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: bold;
}
.timeline .timeline-container .timeline-body .timeline-subtitle {
  font-weight: 300;
  font-style: italic;
  opacity: 0.4;
  margin-top: 16px;
  font-size: 11px;
}
.timeline .timeline-container.primary .badge,
.timeline .timeline-container.primary .timeline-icon {
  background: #1d8cf8 !important;
}
.timeline .timeline-container.info .badge,
.timeline .timeline-container.info .timeline-icon {
  background: #11cdef !important;
}
.timeline .timeline-container.success .badge,
.timeline .timeline-container.success .timeline-icon {
  background: #00bf9a !important;
}
.timeline .timeline-container.warning .badge,
.timeline .timeline-container.warning .timeline-icon {
  background: #ff8d72 !important;
}
.timeline .timeline-container.danger .badge,
.timeline .timeline-container.danger .timeline-icon {
  background: #fd5d93 !important;
}
.timeline .timeline-container.user .badge,
.timeline .timeline-container.user .timeline-icon {
  background-repeat: no-repeat;
  background-size: cover;
}
.author {
  font-family: inherit;
  padding: 3em;
  text-align: center;
  width: 100%;
  color: white;
}
.author a:link,
.author a:visited {
  color: white;
}
.author a:link:hover,
.author a:visited:hover {
  text-decoration: none;
}
.author .btn:link,
.author .btn:visited {
  margin-top: 1em;
  text-decoration: none;
  display: inline-block;
  font-family: inherit;
  font-weight: 100;
  color: white;
  text-align: center;
  vertical-align: middle;
  user-select: none;
  background-color: black;
  padding: 1.5em 2rem;
  border-radius: 1em;
  transition: 0.5s all;
}
.author .btn:link:hover, .author .btn:link:focus, .author .btn:link:active,
.author .btn:visited:hover,
.author .btn:visited:focus,
.author .btn:visited:active {
  background-color: #2A2E43;
}
.timeline-title-span{
  margin-left: 10px;
  font-size: 16.5px;
}
.timeline-subtitle-rightside {
  text-align: right;
}
.i-style-timeline {
  font-size: 18.5px;
}
.timeline-title-right{
  text-align: right;
}
.share-div {
  display: inline-block;
  text-decoration:none;
}
.share-a {
  color:#ffffff;
  background: #4285F4;
  border-radius:4px;
  text-align:center;
  text-decoration:none;
  font-family:fontawesome;
  position: relative;
  display: inline-block;
  width:40px;
  height:40px;
  padding-top:12px;
  margin:0 2px;
  -o-transition:all .5s;
  -webkit-transition: all .5s;
  -moz-transition: all .5s;
  transition: all .5s;
  -webkit-font-smoothing: antialiased;
}
.share-a:hover {
  color: #ffffff;
  background: #7aa6ea;
  text-decoration:none;
}
.share-a:nth-of-type(1):before {
content:'\f09a';
}
.share-a:nth-of-type(2):before {
content:'\f099';
}
.share-a:nth-of-type(3):before {
content:'\f0d5';
}
.share-a:nth-of-type(4):before {
content:'\f113';
}
.share-a:nth-of-type(5):before {
content:'\f17d';
}
.share-a:nth-of-type(6):before {
content:'\f1cb';
}
.bg-main-header {
  color: #ffffff;
  background-color: #2A2E43;
}
.text-color-white{
  color: #ffffff;
}
.circle-img {
  width: 100px;
	height: 100px;
	object-fit: cover;
	border-radius: 50% !important;
  border: 1.5px solid #fafafa;
  background-color: #fafafa;
}
.range-specification{
  max-width: 1050px;
  margin: 0 auto;
}
.timeline-in-a {
  color: #ffffff;
  text-decoration: none;
}
.timeline-in-a:hover{
  color: #ffffff;
  text-decoration: none;
}
.text-align-center{
  text-align: center;
}
</style>
<script type='text/javascript' src='https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js'></script>
<script>
var mymap = L.map('mapid', {preferCanvas: true,});
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
minZoom: 5,
maxZoom: 19,
attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, '
}).addTo(mymap);
var pulsingIcon2 = L.icon.pulse({
iconSize:[20,20]
,color:'#006400'
,fillColor:'#009600'
,heartbeat: 2
});
function onLocationFound(e){
  L.Icon.Default.imagePath = 'https://unpkg.com/leaflet@1.3.1/dist/images/';
  L.marker(e.latlng, {icon:pulsingIcon2}).addTo(mymap);
}
function InputPinLocation(Location){
  const lat = Location.coords.longitude;
  const lng = Location.coords.latitude;
  var elem = document.getElementById("pin_x"); elem.innerHTML = "<input type='hidden' name='pin_x' id='id_pin_x' class='form-control' value = " + lat + ">";
  var elem = document.getElementById("pin_y"); elem.innerHTML = "<input type='hidden' name='pin_y' id='id_pin_y' class='form-control' value = " + lng + ">";
}
function onLocationError(e){
  alert("Could not retrieve current location. 現在地を取得できませんでした。" + e.message);
}
var data = [
  {% for posts in others_user_post_list %}
  {"loc":[{{ posts.pin_x }}, {{ posts.pin_y }}],
  "title": "{{ posts.title }}",
  "title_link": "{% url 'post:post_details' pk=posts.pk %}",
  "text": `{{ posts.text | safe | linebreaksbr | truncatechars:110 }}`,
  "tag": "{{ posts.tag.names.0 }}",
  "web_link": "{{ posts.web_link }}",
  "twitter_link": "{{ posts.twitter_link }}",
  "instagram_link": "{{ posts.instagram_link }}",
  {% if posts.video %}
  "video": "{{ posts.video.url }}",
  {% endif %}
  "image": "{{ posts.image }}"},
  {% endfor %}
];
for (i in data){
  var marker = L.marker(data[i].loc, { riseOnHover: true }).addTo(mymap);
  marker.bindPopup(`
    <div class="flex">
    <div class="card">
    <div class="header">
    <div class="title">
    <div>
    <h1>` + data[i].title + `</h1>
    <h6><span>by</span> LandLim Member</h6>
    </div>
    </div>
    </div>
    <div class="content">
    <div class="closebar">
    <h1>5 ways to create...</h1>
    <a href="#0" class="closebttn"><i class="material-icons">&#xE5CD;</i></a>
    </div>
    <p class="p">` + data[i].text + `</p><hr>` +
    '<p class="p"><a href="' + data[i].web_link + '">' + data[i].web_link + '</a></p>' +
    '<p class="p"><a href="' + data[i].twitter_link + '">' + data[i].twitter_link + '</a></p>' +
    '<p class="p"><a href="' + data[i].instagram_link + '">' + data[i].instagram_link + '</a></p>' +
    '<img class="popImage" src="' + data[i].image + '">' +
    '<video class="IndexCardVideo" autoplay muted playsinline preload="none" controls>' +
      '<source src="'+ data[i].video + '"></source>' +
      '<source src="'+ data[i].video + '"></source>' +
      '<source src="'+ data[i].video + '"></source>' +
      '<source src="'+ data[i].video + '"></source>' +
    '</video>' +
    '<a style="font-size: 15.5px;" href="' + data[i].title_link + '" class="bttn">Read Full Article</a>' + `
    </div>
    </div>
    </div>
    <div class="articlemeta">
    <ul class="left">
    <li><i class="material-icons">&#xE15E;</i></li>
    <li><i class="material-icons">&#xE87D;</i></li>
    </ul>
    <ul class="right">
    <li><i class="fab fa-twitter  "></i></li>
    </ul>
    </div>
  `);
}
mymap.on('locationfound', onLocationFound);
mymap.on('locationerror', onLocationError);
mymap.locate({setView: true, minZoom: 5, maxZoom: 19, timeout: 20000});
mymap.zoomControl.setPosition('bottomright');
mymap.sharelocationControl.setPosition('bottomright');
navigator.geolocation.getCurrentPosition(InputPinLocation,onLocationError);
</script>
<script>
$(document).on('click', '#follow-button', function (e) {
  e.preventDefault();
  let $btn = $(this);
  if ($btn.hasClass('on')) {
    $btn.removeClass('on');
    $btn.children("i").attr('class', 'fas fa-user mr-1 small-icon');
  } else {
    $btn.addClass('on');
    $btn.children("i").attr('class', 'fas fa-user mr-1 small-icon');
  }
  $.ajax({
    type: 'POST',
    url: '{% url "accounts:follow_unfollow" %}',
    data: {
      userid: $('#follow-button').val(),
      csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
      action: 'post'
    },
    success: function (json) {
      document.getElementById("follower_count").innerHTML = json['result']
    },
    error: function (xhr, errmsg, err) {
    }
  });
})
</script>
<script>
$(document).on('click', '#block-button', function (e) {
  e.preventDefault();
  let $btn = $(this);
  if ($btn.hasClass('on')) {
    $btn.removeClass('on');
    $btn.children("i").attr('class', 'fas fa-bell-slash small-icon');
  } else {
    $btn.addClass('on');
    $btn.children("i").attr('class', 'fas fa-bell-slash small-icon');
  }
  $.ajax({
    type: 'POST',
    url: '{% url "accounts:block_unblock" %}',
    data: {
      userid: $('#block-button').val(),
      csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
      action: 'post'
    },
    success: function (json) {
      document.getElementById("block_count").innerHTML = json['result']
    },
    error: function (xhr, errmsg, err) {
    }
  });
})
</script>
{% block extend_js %}
<script src="{% static 'js/message.js' %}"></script>
<script>
$('.Shortcuts a').click(function(event) {
  var id = $(this).attr("href");
  var offset = 70;
  var target = $(id).offset().top - offset;
  $('html, body').animate({
      scrollTop: target
  }, 500);
  event.preventDefault();
});
</script>
{% endblock %}
{% endblock %}